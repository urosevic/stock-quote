jQuery(document).ready(function(e){e('button[name="sq_force_data_fetch_stop"]').on("click",function(t){t.preventDefault(),e(this).data("stop","true")}),e('button[name="sq_force_data_fetch"]').on("click",function(t){t.preventDefault();var a=this,s=e('button[name="sq_force_data_fetch_stop"]'),o=60/e('select[name="stockquote_defaults[av_api_tier]"]').val()*1e3;e(a).prop("disabled",!0),e(s).addClass("enabled"),e.ajax({type:"post",dataType:"json",async:!0,url:stockQuoteJs.ajax_url,data:{action:"stockquote_purge_cache"}}).done(function(t){function n(){e.ajax({type:"post",dataType:"json",async:!0,url:stockQuoteJs.ajax_url,data:{action:"stockquote_update_quotes"}}).done(function(t){if(t.done||"true"==e(s).data("stop"))"DONE"!=t.message?e(".sq_force_data_fetch").append("<br />[STOP] "+t.symbol+": "+t.message+"<br />Fetch interrupted by user."):e(".sq_force_data_fetch").append("<br />DONE"),e(a).prop("disabled",!1),e(s).removeClass("enabled").data("stop","false");else{if(e.inArray(t.status,["wait","skip","timeout","invalid","success"])>=0){var c="<strong>"+t.symbol+"</strong> | <em>"+t.message+"</em>";e.inArray(t.status,["timeout","invalid"])>=0&&(c+=' (<a href="'+stockQuoteJs.avurl+t.symbol+'" target="_blank">test</a>)'),c="["+t.status.replace("success","ok").toUpperCase()+"] "+c+"<br />"}else c="[?] <strong>"+t.symbol+"</strong> | <em>"+t.message+"</em><br />";e(".sq_force_data_fetch").append(c),setTimeout(function(){n()},o)}}).fail(function(t){e(".sq_force_data_fetch").append("<br />[ERROR] "+t.message)})}e(".sq_force_data_fetch").html("Reset fetching loop and fetch data again.<br />"),e(".sq_force_data_fetch").append("Between each symbol fetch we will wait "+o/1e3+" second(s) to fullfill API Key Tier rules. Please wait...<br /><br />"),n()})})});